(async()=>{let t,e;const o=await async function(){try{const t=await fetch("/propose.json");if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return await t.json()}catch(t){console.error("Error fetching data:",t)}}();if(o.preloader){const n=await fetch(o.preloader);if(!n.ok)throw new Error(`Failed to fetch /preloader.html: ${n.statusText}`);t=await n.text(),e=document.createElement("div"),e.innerHTML=t,Object.assign(e.style,{height:"100vh",position:"fixed",left:"0",right:"0",top:"0",zIndex:"999"}),document.body.appendChild(e)}if(o.constant&&await async function(t){try{const e=Object.entries(t).map((async([t,e])=>{const o=await fetch(e);if(!o.ok)throw new Error(`Failed to fetch ${e}`);const n=await o.text(),c=(new Range).createContextualFragment(n);document.querySelector(t).appendChild(c)}));await Promise.all(e)}catch(t){console.error("Error loading content:",t)}}(o.constant),o.common&&(localStorage.removeItem("previousDirectory"),await a(o.common)),o.css.constant&&await async function(t){const e=t.map((async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to fetch CSS: ${e.status}`);const o=await e.text(),n=document.createElement("style");n.setAttribute("data-css",t),n.textContent=o,document.head.appendChild(n)}catch(t){console.error("Error fetching CSS:",t)}}));await Promise.all(e)}(o.css.constant),o.css.common){let t=window.location.pathname;t=t.substring(0,t.lastIndexOf("/")),localStorage.removeItem("commonCSS"),await i(o.css.common)}if(o.css.specific&&await s(o.css.specific),o.script.constant&&await async function(t){try{const e=t.map((async t=>{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to fetch script: ${e.statusText}`);const o=await e.text();new Function(o)()}));await Promise.all(e)}catch(t){console.error("Error executing scripts:",t)}}(o.script.constant),o.script.specific&&await m(o.script.specific),o.script.common&&await l(o.script.common),t){!async function(){await new Promise((t=>setTimeout(t,100))),e.remove()}()}window.scrollTo({top:0});const n=new AbortController;window.addEventListener("popstate",(async()=>{if(n.abort(),o.unique&&await r(o.unique),o.common&&await a(o.common),o.css.common){let t=window.location.pathname;t=t.substring(0,t.lastIndexOf("/")),""===t&&localStorage.removeItem("commonCSS"),await i(o.css.common)}o.css.specific&&await s(o.css.specific),o.script.specific&&await m(o.script.specific),o.script.common&&await l(o.script.common)}));document.querySelectorAll("a").forEach((t=>{t.hasAttribute("target")||t.addEventListener("click",(async e=>{n.abort(),e.preventDefault();const c=t.getAttribute("href");history.pushState({},"",c),o.unique&&await r(o.unique),o.css&&(o.common&&await a(o.common),o.css.common&&await i(o.css.common)),o.css.specific&&await s(o.css.specific),o.script.specific&&await m(o.script.specific),o.script.common&&await l(o.script.common)}))}));const c=t=>{"A"===t.tagName&&t.addEventListener("click",(async e=>{if(!e.target.hasAttribute("target")){n.abort(),e.preventDefault();const c=t.getAttribute("href");history.pushState({},"",c),o.unique&&await r(o.unique),o.css&&(o.common&&await a(o.common),o.css.common&&await i(o.css.common)),o.css.specific&&await s(o.css.specific),o.script.specific&&await m(o.script.specific),o.script.common&&await l(o.script.common)}}))};async function a(e){let o=window.location.pathname,n=o.substring(0,o.lastIndexOf("/"))||"/";if(n!==localStorage.getItem("previousDirectory")&&(localStorage.setItem("previousDirectory",n),e[n])){let o=e[n],c=[];for(let e in o){let n=o[e];t&&(document.querySelector(n).innerHTML=t),c.push(fetch(e).then((t=>t.text().then((t=>({to:n,text:t}))))))}try{(await Promise.all(c)).forEach((({to:t,text:e})=>{const o=(new Range).createContextualFragment(e);document.querySelector(t).replaceWith(o)}))}catch(t){console.error("Error fetching content:",t)}}}async function r(e){e.map((e=>{t&&(document.querySelector(e).innerHTML=t)}));const o=window.location.pathname;try{const t=await fetch(o);if(!t.ok){history.pushState({},"","/404.html");const t=await fetch("/404.html"),o=await t.text(),n=(new Range).createContextualFragment(o),c=e.map((t=>{const e=n.querySelector(t);e?document.querySelector(t).replaceWith(e):console.warn(`Selector ${t} not found in fetched content.`)}));return void await Promise.all(c)}const n=await t.text(),c=(new Range).createContextualFragment(n),a=e.map((t=>{const e=c.querySelector(t);e?document.querySelector(t).replaceWith(e):console.warn(`Selector ${t} not found in fetched content.`)}));await Promise.all(a)}catch(t){console.error("Error fetching or processing content:",t)}}async function i(t){let e=window.location.pathname;e=e.substring(0,e.lastIndexOf("/"))||"/";const o=localStorage.getItem("commonCSS");try{for(let n of Object.keys(t))if(o!==n&&e===n){localStorage.setItem("commonCSS",e);const o=t[n].map((async t=>{if(!document.querySelector(`[data-css='${t}']`))try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to fetch CSS: ${e.status}`);const o=await e.text(),n=document.createElement("style");n.setAttribute("data-css",t),n.textContent=o,document.head.appendChild(n)}catch(t){console.error("Error fetching CSS:",t)}}));await Promise.all(o)}else e!==n&&t[n].forEach((t=>{let e=document.querySelector(`[data-css='${t}']`);e&&(e.remove(),localStorage.removeItem("commonCSS"))}))}catch(t){console.error("Error processing CSS:",t)}}async function s(t){document.head.querySelectorAll("[data-specificss]").forEach((t=>t.remove()));const e=window.location.pathname;if(t[e]){const o=t[e].map((async t=>{try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to fetch ${t}: ${e.statusText}`);const o=await e.text(),n=document.createElement("style");n.setAttribute("data-specificss",t),n.textContent=o,document.head.appendChild(n)}catch(e){console.error(`Error loading CSS from ${t}:`,e)}}));await Promise.all(o)}}async function l(t){const e=window.location.pathname,o=e.substring(0,e.lastIndexOf("/")||"/");for(let e in t)if(o.endsWith(e))for(let o of t[e])fetch(o).then((async t=>{if(!t.ok)throw new Error(`Failed to fetch script: ${t.statusText}`);const e=await t.text(),o=new Function(e),n=new Set,c=new Set,a=window.setTimeout,r=window.setInterval,i=window.clearTimeout,s=window.clearInterval;window.setTimeout=function(t,e,...o){const c=a(t,e,...o);return n.add(c),c},window.setInterval=function(t,e,...o){const n=r(t,e,...o);return c.add(n),n},window.clearTimeout=function(t){n.delete(t),i(t)},window.clearInterval=function(t){c.delete(t),s(t)};const l=Element.prototype.addEventListener,m=new Map;Element.prototype.addEventListener=function(t,e,o){m.has(this)||m.set(this,[]),m.get(this).push({type:t,listener:e,options:o}),l.call(this,t,e,o)},getAllEventListeners=function(){const t=[];return m.forEach(((e,o)=>{e.forEach((e=>{t.push({...e,element:o})}))})),t},o();const w=getAllEventListeners(),d=function(){n.forEach((t=>{window.clearTimeout(t)})),c.forEach((t=>{window.clearInterval(t)})),n.clear(),c.clear()};window.addEventListener("popstate",(async()=>{d(),w.forEach((t=>{t.element.removeEventListener(t.type,t.listener,t.options)}))})),document.querySelectorAll("a").forEach((t=>{t.hasAttribute("target")||t.addEventListener("click",(()=>{d(),w.forEach((t=>{t.element.removeEventListener(t.type,t.listener,t.options)}))}))}))})).catch((t=>{console.error(t)}))}async function m(t){const e=window.location.pathname;for(let o in t)if(e===o)for(let e of t[o])fetch(e).then((async t=>{if(!t.ok)throw new Error(`Failed to fetch script: ${t.statusText}`);const e=await t.text(),o=new Function(e),n=new Set,c=new Set,a=window.setTimeout,r=window.setInterval,i=window.clearTimeout,s=window.clearInterval;window.setTimeout=function(t,e,...o){const c=a(t,e,...o);return n.add(c),c},window.setInterval=function(t,e,...o){const n=r(t,e,...o);return c.add(n),n},window.clearTimeout=function(t){n.delete(t),i(t)},window.clearInterval=function(t){c.delete(t),s(t)};const l=Element.prototype.addEventListener,m=new Map;Element.prototype.addEventListener=function(t,e,o){m.has(this)||m.set(this,[]),m.get(this).push({type:t,listener:e,options:o}),l.call(this,t,e,o)},getAllEventListeners=function(){const t=[];return m.forEach(((e,o)=>{e.forEach((e=>{t.push({...e,element:o})}))})),t},o();const w=getAllEventListeners(),d=function(){n.forEach((t=>{window.clearTimeout(t)})),c.forEach((t=>{window.clearInterval(t)})),n.clear(),c.clear()};window.addEventListener("popstate",(async()=>{d(),w.forEach((t=>{t.element.removeEventListener(t.type,t.listener,t.options)}))})),document.querySelectorAll("a").forEach((t=>{t.hasAttribute("target")||t.addEventListener("click",(()=>{d(),w.forEach((t=>{t.element.removeEventListener(t.type,t.listener,t.options)}))}))}))})).catch((t=>{console.error(t)}))}new MutationObserver((t=>{t.forEach((t=>{t.addedNodes.forEach((t=>{1===t.nodeType&&(c(t),t.querySelectorAll("a").forEach((t=>c(t))))}))}))})).observe(document.body,{childList:!0,subtree:!0})})();